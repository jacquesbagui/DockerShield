from src.core.scanner import Scanner, ScanResult
import yara

class MalwareScanner(Scanner):
    def __init__(self, rules_file):
        self.rules = yara.compile(rules_file)

    def scan(self, file_path):
        matches = self.rules.match(file_path)
        findings = [
            {
                'rule': match.rule,
                'tags': match.tags,
                'strings': match.strings
            } for match in matches
        ]
        return ScanResult('MalwareScanner', findings)