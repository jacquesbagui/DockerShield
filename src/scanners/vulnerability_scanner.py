import subprocess
import json
from src.core.scanner import Scanner, ScanResult

class VulnerabilityScanner(Scanner):
    def scan(self, image_name):
        try:
            result = subprocess.run(['trivy', 'image', '--format', 'json', image_name], 
                                    capture_output=True, text=True, check=True)
            vulnerabilities = json.loads(result.stdout)
            return ScanResult('VulnerabilityScanner', vulnerabilities)
        except subprocess.CalledProcessError as e:
            return ScanResult('VulnerabilityScanner', {'error': str(e)})